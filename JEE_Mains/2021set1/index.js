const questions = [
    {
        "Number": 1,
        "question": "2021_1/Q01.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 2,
        "question": "2021_1/Q02.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 3,
        "question": "2021_1/Q03.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 4,
        "question": "2021_1/Q04.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 5,
        "question": "2021_1/Q05.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 6,
        "question": "2021_1/Q06.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 7,
        "question": "2021_1/Q07.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 8,
        "question": "2021_1/Q08.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 9,
        "question": "2021_1/Q09.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 10,
        "question": "2021_1/Q10.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 11,
        "question": "2021_1/Q11.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 12,
        "question": "2021_1/Q12.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 13,
        "question": "2021_1/Q13.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 14,
        "question": "2021_1/Q14.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 15,
        "question": "2021_1/Q15.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 16,
        "question": "2021_1/Q16.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 17,
        "question": "2021_1/Q17.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 18,
        "question": "2021_1/Q18.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 19,
        "question": "2021_1/Q19.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 20,
        "question": "2021_1/Q20.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 21,
        "question": "2021_1/Q21.JPG",
        "answer": "1",
        "section": 2,
    },
    {
        "Number": 22,
        "question": "2021_1/Q22.JPG",
        "answer": "440",
        "section": 2,
    },
    {
        "Number": 23,
        "question": "2021_1/Q23.JPG",
        "answer": "25",
        "section": 2,
    },
    {
        "Number": 24,
        "question": "2021_1/Q24.JPG",
        "answer": "75",
        "section": 2,
    },
    {
        "Number": 25,
        "question": "2021_1/Q25.JPG",
        "answer": "25600",
        "section": 2,
    },
    {
        "Number": 26,
        "question": "2021_1/Q26.JPG",
        "answer": "200",
        "section": 2,
    },
    {
        "Number": 27,
        "question": "2021_1/Q27.JPG",
        "answer": "15",
        "section": 2,
    },
    {
        "Number": 28,
        "question": "2021_1/Q28.JPG",
        "answer": "25",
        "section": 2,
    },
    {
        "Number": 29,
        "question": "2021_1/Q29.JPG",
        "answer": "25",
        "section": 2,
    },
    {
        "Number": 30,
        "question": "2021_1/Q30.JPG",
        "answer": "25",
        "section": 2,
    },
    {
        "Number": 31,
        "question": "2021_1/Q31.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 32,
        "question": "2021_1/Q32.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 33,
        "question": "2021_1/Q33.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 34,
        "question": "2021_1/Q34.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 35,
        "question": "2021_1/Q35.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 36,
        "question": "2021_1/Q36.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 37,
        "question": "2021_1/Q37.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 38,
        "question": "2021_1/Q36.JPG",
        "answer": "3",
        "section": 1,
    },
    {
        "Number": 39,
        "question": "2021_1/Q39.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 40,
        "question": "2021_1/Q40.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 41,
        "question": "2021_1/Q41.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 42,
        "question": "2021_1/Q42.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 43,
        "question": "2021_1/Q43.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 44,
        "question": "2021_1/Q44.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 45,
        "question": "2021_1/Q45.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 46,
        "question": "2021_1/Q46.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 47,
        "question": "2021_1/Q47.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 48,
        "question": "2021_1/Q48.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 49,
        "question": "2021_1/Q49.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 50,
        "question": "2021_1/Q50.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 51,
        "question": "2021_1/Q51.JPG",
        "answer": "2",
        "section": 2,
    },
    {
        "Number": 52,
        "question": "2021_1/Q52.JPG",
        "answer": "12",
        "section": 2,
    },
    {
        "Number": 53,
        "question": "2021_1/Q53.JPG",
        "answer": "5",
        "section": 2,
    },
    {
        "Number": 54,
        "question": "2021_1/Q54.JPG",
        "answer": "1",
        "section": 2,
    },
    {
        "Number": 55,
        "question": "2021_1/Q55.JPG",
        "answer": "2",
        "section": 2,
    },
    {
        "Number": 56,
        "question": "2021_1/Q56.JPG",
        "answer": "12",
        "section": 2,
    },
    {
        "Number": 57,
        "question": "2021_1/Q57.JPG",
        "answer": "5",
        "section": 2,
    },
    {
        "Number": 58,
        "question": "2021_1/Q58.JPG",
        "answer": "7.5",
        "section": 2,
    },
    {
        "Number": 59,
        "question": "2021_1/Q59.JPG",
        "answer": "26",
        "section": 2,
    },
    {
        "Number": 60,
        "question": "2021_1/Q60.JPG",
        "answer": "8",
        "section": 2,
    },
    {
        "Number": 61,
        "question": "2021_1/Q61.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 62,
        "question": "2021_1/Q62.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 63,
        "question": "2021_1/Q63.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 64,
        "question": "2021_1/Q64.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 65,
        "question": "2021_1/Q65.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 66,
        "question": "2021_1/Q66.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 67,
        "question": "2021_1/Q67.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 68,
        "question": "2021_1/Q66.JPG",
        "answer": "1",
        "section": 1,
    },
    {
        "Number": 69,
        "question": "2021_1/Q69.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 70,
        "question": "2021_1/Q70.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 71,
        "question": "2021_1/Q71.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 72,
        "question": "2021_1/Q72.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 73,
        "question": "2021_1/Q73.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 74,
        "question": "2021_1/Q74.JPG",
        "answer": '2',
        "section": 1
    },
    {
        "Number": 75,
        "question": "2021_1/Q75.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 76,
        "question": "2021_1/Q76.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 77,
        "question": "2021_1/Q77.JPG",
        "answer": '3',
        "section": 1
    },
    {
        "Number": 78,
        "question": "2021_1/Q78.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 79,
        "question": "2021_1/Q79.JPG",
        "answer": '4',
        "section": 1
    },
    {
        "Number": 80,
        "question": "2021_1/Q80.JPG",
        "answer": '1',
        "section": 1
    },
    {
        "Number": 81,
        "question": "2021_1/Q81.JPG",
        "answer": "3",
        "section": 2,
    },
    {
        "Number": 82,
        "question": "2021_1/Q82.JPG",
        "answer": "9",
        "section": 2,
    },
    {
        "Number": 83,
        "question": "2021_1/Q83.JPG",
        "answer": "75",
        "section": 2,
    },
    {
        "Number": 84,
        "question": "2021_1/Q84.JPG",
        "answer": "3",
        "section": 2,
    },
    {
        "Number": 85,
        "question": "2021_1/Q85.JPG",
        "answer": "17",
        "section": 2,
    },
    {
        "Number": 86,
        "question": "2021_1/Q86.JPG",
        "answer": "6",
        "section": 2,
    },
    {
        "Number": 87,
        "question": "2021_1/Q87.JPG",
        "answer": "5",
        "section": 2,
    },
    {
        "Number": 88,
        "question": "2021_1/Q88.JPG",
        "answer": "10",
        "section": 2,
    },
    {
        "Number": 89,
        "question": "2021_1/Q89.JPG",
        "answer": "540",
        "section": 2,
    },
    {
        "Number": 90,
        "question": "2021_1/Q90.JPG",
        "answer": "1",
        "section": 2,
    },
]

let questionsImg = document.getElementById('questions-img')
let questionNumber = document.getElementById('question-num')
let proceed = document.getElementById('proceed')
let timer = document.getElementById('timer')
let notVisitedCount = document.getElementById('notvisitedCount')
let notansweredCount = document.getElementById('notansweredCount')
let answeredCount = document.getElementById('answeredCount')
let reviewCount = document.getElementById('reviewCount')
let ansNreviewCount = document.getElementById('ansNreviewCount')
let numberList = document.getElementById('number-list')
let radioBtn = document.getElementsByClassName('radio')
let confirm = document.getElementById('confirm')
let instructions = document.getElementById('instructions')
let Marks = 0;
let index = 0;
let score = 0;
let btnIndex = 4
let response = "" 
let result = ""

//Set up a temporary array of questions
//append or modify the temp array according to the responses
//when test is over delete or revert that array

let tempArr = []
tempArr = questions.map(elem => ({ ...elem, btnIndex: btnIndex, response: response, result: result }))


//intialize page
questionsImg.innerHTML = `<img src=${questions[index].question} alt=""/>`
questionNumber.innerHTML = `${index + 1}`


//Index page proceed button function
function startTest() {
    if (!confirm.checked) {
        document.getElementById('warning1').classList.remove('hide')
    } else {
        location.href = "/JEE_Mains/2021set1/questions.html"
    }
}

function hideWarning() {
    document.getElementById('warning1').classList.add('hide')
}

//Starts test
function start() {
    display(index)
}

//Display questions
function display(i) {
    questionsImg.innerHTML = `<img src=${questions[i].question} alt=""/>`
    questionNumber.innerText = i + 1
    if (questions[i].section == 1) {
        document.getElementById('radio-btn').classList.remove('hide')
        document.getElementById('radio-btn').classList.add('show')
        document.getElementById('input-response').classList.add('hide')
        document.getElementById('input-response').classList.remove('show')
        instructions.innerText = ""
    } else if (questions[i].section == 2) {
        document.getElementById('input-response').classList.remove('hide')
        document.getElementById('input-response').classList.add('show')
        document.getElementById('radio-btn').classList.add('hide')
        document.getElementById('radio-btn').classList.remove('show')
        instructions.innerHTML = `<p>This Section contains 10 questions. Each question is numerical value type. For each question, enter the correct numerical value (in decimal notation, turncated/ rounded-off to second decimal place.) Attempt any five questions out of 10. <br><strong>Marking scheme: +4 for correct answer, 0 if not attempted and 0 in all other cases.</strong></p>`
    }
}

//Keypad
let inputVal = document.getElementById('input-value')
let buttons = document.getElementsByClassName('num-pad-btn')
let screenValue = "";
for (item of buttons) {
    item.addEventListener('click', (e) => {
        buttonText = e.target.innerText;
        if (buttonText == 'C') {
            screenValue = "";
            inputVal.value = screenValue
        } else {
            screenValue += buttonText;
            inputVal.value = screenValue
        }

    })
}
//Tag button group

//Save and next
function saveNext() {
    if (radioBtn[0].checked || radioBtn[1].checked || radioBtn[2].checked || radioBtn[3].checked || !inputVal.value == "") {
        let qNum = questionNumber.innerHTML
        if (!numberList.children[qNum - 1].classList.contains('answered')) {
            answeredCount.innerHTML = parseInt(answeredCount.innerHTML) + 1;
        }
        notVisitedCount.innerHTML = parseInt(notVisitedCount.innerHTML) - 1;


        if (notansweredCount.innerHTML > 0) {
            notansweredCount.innerHTML = parseInt(notansweredCount.innerHTML) - 1;
        }
        numberList.children[qNum - 1].classList.remove('notvisited');
        numberList.children[qNum - 1].classList.remove('notanswered');
        numberList.children[qNum - 1].classList.add('answered');
        numberList.children[qNum].classList.add('notanswered');
        index = parseInt(questionNumber.innerText);
        display(index)
        store()
    }
    else {
        alert("Please choose an option")
    }
}

//CLEAR
function uncheck() {
    radioBtn[0].checked = false;
    radioBtn[1].checked = false;
    radioBtn[2].checked = false;
    radioBtn[3].checked = false;
    answeredCount.innerHTML = parseInt(answeredCount.innerHTML) - 1;
    notansweredCount.innerHTML = parseInt(notansweredCount.innerHTML) + 1;
    let qNum = questionNumber.innerHTML
    numberList.children[qNum - 1].classList.remove('notvisited');
    numberList.children[qNum - 1].classList.remove('answered');
    numberList.children[qNum - 1].classList.add('notanswered');
    let score = localStorage.getItem('score')
    if (score == null) {
        scoreArr = []
    }
    else {
        scoreArr = JSON.parse(score)
    }
    console.log(scoreArr)

}

//Save and mark for review
function saveReview() {
    if (radioBtn[0].checked || radioBtn[1].checked || radioBtn[2].checked || radioBtn[3].checked) {
        ansNreviewCount.innerHTML = parseInt(ansNreviewCount.innerHTML) + 1;
        notVisitedCount.innerHTML = parseInt(notVisitedCount.innerHTML) - 1;
        let qNum = questionNumber.innerHTML
        numberList.children[qNum - 1].classList.remove('notvisited');
        numberList.children[qNum - 1].classList.remove('notanswered');
        numberList.children[qNum - 1].classList.add('ansNreview');
        numberList.children[qNum].classList.add('notanswered');
        index = parseInt(questionNumber.innerText);
        display(index)
        store()
    }
    else {
        alert("Please choose an option")
    }
}

//Mark for review and next
function reviewNext() {
    reviewCount.innerHTML = parseInt(reviewCount.innerHTML) + 1;
    notVisitedCount.innerHTML = parseInt(notVisitedCount.innerHTML) - 1;
    let qNum = questionNumber.innerHTML
    numberList.children[qNum - 1].classList.remove('notvisited');
    numberList.children[qNum - 1].classList.remove('notanswered');
    numberList.children[qNum - 1].classList.add('review');
    numberList.children[qNum].classList.add('notanswered');
    index = parseInt(questionNumber.innerText);
    display(index)
}


//Update number board with CSS
function gotoQuestion(q) {
    if (numberList.children[q - 1].classList.contains('notvisited')) {
        notansweredCount.innerHTML = parseInt(notansweredCount.innerHTML) + 1;
        notVisitedCount.innerHTML = parseInt(notVisitedCount.innerHTML) - 1;
    }
    display(q - 1);
    numberList.children[q - 1].classList.remove('notvisited');
    numberList.children[q - 1].classList.add('notanswered');
    console.log(tempArr[q - 1].btnIndex)
    radioBtn[tempArr[q - 1].btnIndex].checked = true

}

//Countdown
var date1 = new Date()
var countDownDate = new Date()
countDownDate.setTime(date1.getTime() + (3 * 60 * 60 * 1000));

// Update the count down every 1 second
var x = setInterval(function () {

    // Get today's date and time
    var now = new Date().getTime();

    // Find the distance between now and the count down date
    var distance = countDownDate - now;

    // Time calculations for days, hours, minutes and seconds
    var hours = Math.floor((distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
    var minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60));
    var seconds = Math.floor((distance % (1000 * 60)) / 1000);

    // Display the result in the element with id="demo"
    document.getElementById("timer").innerHTML = hours + ":"
        + minutes + ":" + seconds;

    // If the count down is finished, write some text
    if (distance < 0) {
        clearInterval(x);
        document.getElementById("timer").innerHTML = "EXPIRED";
        document.getElementById('questionDisplay').classList.add('hide');
        document.getElementById('scoreboard').classList.remove('hide')
        document.getElementById('scoreboard').classList.add('show')
    }
}, 1000);

//Storage and evaluation
function store() {
    let qNum = questionNumber.innerHTML - 1

    if (questions[qNum - 1].section == 1) {
        for (var i = 0; i < 4; i++) {
            if (radioBtn[i].checked) {
                tempArr[qNum - 1].response = radioBtn[i].value
                tempArr[qNum - 1].btnIndex = i;
                if (radioBtn[i].value == questions[qNum - 1].answer) {
                    tempArr[qNum - 1].result = "CORRECT"
                    Marks += 4
                } else {
                    tempArr[qNum - 1].result = "INCORRECT"
                    Marks -= 1
                }
            }
        }
    }
    else if (questions[qNum - 1].section == 2) {
        tempArr[qNum - 1].response = inputVal.value

        if (questions[qNum - 1].answer == parseFloat(inputVal.value)) {
            tempArr[qNum - 1].result = "CORRECT"
            Marks += 4
        } else {
            tempArr[qNum - 1].result = "INCORRECT"
            Marks -= 1
        }
    }

    let html = ""
    tempArr.forEach(function (element) {
        html += `
        <h2>Question No.: ${element.Number}</h2>
        <div><img src=${element.question} alt=""></div>
        <p>Your Response:${element.response} 
            <br>
           Answer:${element.answer}
           <br>
           Result:${element.result}
        </p>
        `
    })

    var scorelist = document.getElementById('scorelist')
    scorelist.innerHTML = html

    document.getElementById('marksDisplay').innerText = `${Marks}`

    radioBtn[0].checked = false
    radioBtn[1].checked = false
    radioBtn[2].checked = false
    radioBtn[3].checked = false
    inputVal.value = ""
}

//Display scorecard
function scorecard() {
    clearInterval(x);
    document.getElementById("timer").innerHTML = "EXPIRED";
    document.getElementById('questionDisplay').classList.add('hide');
    document.getElementById('scoreboard').classList.remove('hide')
    document.getElementById('scoreboard').classList.add('show')
}

